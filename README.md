# Описание

**YaMDb API** - это учебный проект от Яндекс.Практикум, который собирает отзывы ***(Review)*** пользователей на произведения ***(Titles)***. 
* Произведения делятся на категории ***(Category)***: «Книги», «Фильмы», «Музыка». Список может быть расширен администратором;
* В каждой категории есть **произведения**: книги, фильмы или музыка;
* Произведению может быть присвоен жанр ***(Genre)*** из списка предустановленных (например, «Сказка», «Рок» или «Артхаус»). Новые жанры может создавать только администратор;
* Пользователи оставляют к произведениям текстовые отзывы **(Review)** и комментарии **(Comment)**, а так же ставят произведению оценку в диапазоне от одного до десяти (целое число);
* Из пользовательских оценок формируется усреднённая оценка произведения — **рейтинг** (целое число).

## Задача проекта:

На данном этапе проекта предполагается написать бэкенд проекта ***(приложение reviews)*** и API для него ***(приложение api)***.
Так же неотъемлемой частью проекта является регистрация пользователей и роли для них:

## Алгоритм регистрации пользователей:

* Пользователь отправляет POST-запрос на добавление нового пользователя с параметрами `email` и `username` на эндпоинт `/api/v1/auth/signup/`.
* **YaMDB** отправляет письмо с кодом подтверждения (`confirmation_code`) на адрес  `email`.
* Пользователь отправляет POST-запрос с параметрами `username` и `confirmation_code` на эндпоинт `/api/v1/auth/token/`, в ответе на запрос ему приходит `token` (JWT-токен).
* При желании пользователь отправляет PATCH-запрос на эндпоинт `/api/v1/users/me/` и заполняет поля в своём профайле.

## Пользовательские роли:

* ***Аноним*** — может просматривать описания произведений, читать отзывы и комментарии.
* ***Аутентифицированный пользователь*** (`user`) — может, как и **Аноним**, читать всё, дополнительно он может публиковать отзывы и ставить оценку произведениям (фильмам/книгам/песенкам), может комментировать чужие отзывы; может редактировать и удалять **свои** отзывы и комментарии. Эта роль присваивается по умолчанию каждому новому пользователю.
* ***Модератор*** (`moderator`) — те же права, что и у **Аутентифицированного пользователя** плюс право удалять **любые** отзывы и комментарии.
* ***Администратор*** (`admin`) — полные права на управление всем контентом проекта. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям. 
* ***Суперюзер Django*** — обладет правами администратора (`admin`)


## Для взаимодействия с ресурсами настроены следующие эндпоинты:

* `api/v1/auth/signup/` Регистрация нового пользователя.
* `api/v1/auth/token/` Получение JWT-токена.
* `api/v1/categories/` Получение списка всех категорий. Добавление категории.
* `api/v1/categories/{slug}/` Удаление категории.
* `api/v1/genres/` Получение списка всех жанров. Добавление жанра.
* `api/v1/genres/{slug}/` Удаление жанра.
* `api/v1/titles/` Получение списка всех произведений. Добавление произведения.
* `api/v1/titles/{titles_id}/` Получение информации о произведении, а так же частичное обновление и удаление.
* `api/v1/titles/{title_id}/reviews/` Получение списка всех отзывов. Добавление отзыва.
* `api/v1/titles/{title_id}/reviews/{review_id}/` Получить, частично обновить и удалить отзыв по `id` для указанного произведения.
* `api/v1/titles/{title_id}/reviews/{review_id}/comments/` Получение списка всех комментариев к отзыву. Добавление комментария.
* `api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/` Получить, частично обновить, удалить комментарий для отзыва по `id`.
* `api/v1/users/` Получение списка всех пользователей. Добавление пользователя.
* `api/v1/users/{username}/` Получение, изменение и удаление пользователя по username.
* `api/v1/users/me/` Изменение данных своей учетной записи.

## База данных

В репозитории с заданием подготовлены несколько файлов в формате csv с контентом для ресурсов ***Users, Titles, Categories, Genres, Review и Comments***.

Для заполнения БД написан скрипт, который можно запустить командой 
`python manage.py load_from_csv`

## Как развернуть проект на локальной машине:

Клонировать репозиторий и перейти в него в командной строке:

```
git clone git@github.com:AShelpyakov/api_yamdb.git
```

```
cd api_yamdb
```

Cоздать и активировать виртуальное окружение:

```
python -m venv env
```

```
source venv\Scripts\activate
```

Установить зависимости из файла requirements.txt:

```
python -m pip install --upgrade pip
```

```
pip install -r requirements.txt
```

Выполнить миграции:

```
python manage.py migrate
```

Запустить проект:

```
python manage.py runserver
```
## Запуск docker-compose:

Запуск приложения:
```
$ docker-compose up OR $ docker-compose up --build
```
Команда для выполнения миграций:
```
$ docker-compose exec web python manage.py migrate
```
Команда для заполнения базы начальными данными:
```
$ docker-compose exec web python manage.py loaddata fixtures.json 
```

## Над проектом работали:

**[Александр Шельпяков](https://github.com/AShelpyakov)**. Управление пользователями: система регистрации и аутентификации, права доступа, работа с токеном, система подтверждения e-mail, поля.

**[Максим Антонов](https://github.com/MakcAntov)**. Категории, жанры и произведения: модели, view и эндпойнты для них. Скрипт для заполнения БД.

**[Анна Шульгина](https://github.com/motheranarkia)**. Отзывы и комментарии: модели и view, эндпойнты, права доступа для запросов. Рейтинги произведений.

***А это котик, который пристально наблюдал за ходом работы над проектом.***

![alt text](https://telegrator.ru/wp-content/uploads/2021/05/chat_avatar-136.jpg)
